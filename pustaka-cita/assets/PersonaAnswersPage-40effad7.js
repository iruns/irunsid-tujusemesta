import{d as V,b as L,J as X,c as o,w as E,x as J,o as v,a as y,e as t,t as b,u as e,C as F,n as A,h as U,I as G,z as W,m as D,K as C,F as q,i as K,L as Y,l as j,M as Z,N as $,O as N,Q as ee,S as se,r as z,f as te,_ as ne}from"./index-5aedd1f3.js";const T="data:image/webp;base64,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",R=[{until:4,focusBetween:12},{until:6,focusBetween:12},{until:1/0,focusBetween:12}],ae={class:"picture main"},oe={class:"cover"},le={class:"bottom"},re=t("img",{class:"paper",src:T},null,-1),ie={class:"symbol"},ce={class:"picture sub bottom"},ue=t("img",{class:"paper",src:T},null,-1),de={class:"symbol"},pe={class:"instruction"},ve=["onClick"],xe=["onClick"],me=V({__name:"PersonaStepSet",props:{mainStepIdx:null,idxOffset:{default:0},onSelect:null},setup(g){const k=g,w=L(),I=X(),_=o(()=>w.progressData.personaHistory),f=o(()=>_.value[k.mainStepIdx]),S=o(()=>Y[f.value.questionId]),l=o(()=>{const s=f.value.selectedAnswerIdx;return s??null}),P=o(()=>{const s=_.value[k.mainStepIdx+1];return s?Y[s.questionId]:null}),h=o(()=>{const s=S.value.id.split(".");return{x:Number(s[0])-1,y:Number(s[1])-1}}),H=o(()=>{let s=0,r=R[s];for(;k.mainStepIdx>r.until;)s++,r=R[s];return r}),O=o(()=>w.resultData.personaScoresSum),u=o(()=>{const s=j.map(i=>i.id);s.sort((i,p)=>O.value[p]-O.value[i]);const r=H.value.focusBetween;return s.slice(0,r)}),d=o(()=>{const{answers:s}=S.value,r=u.value,i=s.map(c=>{let Q=0;return r.forEach(B=>Q+=c.scores[B]||0),[c.idx,Q]});i.sort((c,Q)=>Q[1]-c[1]);const p=[];for(let c=0;c<2;c++)p.push(s[i.pop()[0]]);for(let c=0;c<i.length;c++){const[Q,B]=i[c];B&&p.push(s[Q])}return p}),a=o(()=>P.value?P.value.answers:null),n=E(null),x=E(null),m=E(0),M=E(0);return J(n,s=>{s&&Z(()=>{const r=s.getClientRects()[0];m.value=r.height})},{immediate:!0}),J(a,s=>{s&&Z(()=>{const r=x.value.getClientRects()[0];M.value=r.height})},{immediate:!0}),(s,r)=>(v(),y("div",{class:A(["step-set",g.idxOffset?g.idxOffset==1?"next-1":g.idxOffset==-1?"prev-1":!1:"active"])},[t("p",{class:A(["instruction",{inactive:e(l)!=null}])},b(e(F)("1")),3),t("div",{class:A(["step",[e(l)==null?"main-step":"sub-step"]])},[t("div",ae,[t("div",oe,[U(G,{src:"persona-books.webp","x-sprites":5,"y-sprites":2,x:e(h).x,y:e(h).y,class:A({"active-shape":e(l)==null})},null,8,["x","y","class"])]),t("div",le,[re,t("div",ie,[U(G,{src:"persona-main-question-shapes.webp","x-sprites":5,"y-sprites":2,x:e(h).x,y:e(h).y,class:A({"active-shape":e(l)==null})},null,8,["x","y","class"])])])]),t("div",ce,[ue,t("div",de,[e(l)!=null?(v(),W(G,{key:0,src:"persona-sub-question-shapes.webp","x-sprites":5,"y-sprites":4,x:e(h).x,y:e(h).y*2+e(l)},null,8,["x","y"])):D("",!0)])])],2),t("p",{class:A(["instruction",{inactive:e(l)==null}])},b(e(F)("2")),3),t("p",pe,b(e(F)("3")),1),t("div",{class:"answers-sets",style:C({height:(e(a)?M.value:m.value)+"px"})},[t("div",{ref_key:"mainAnswersEl",ref:n,class:A(["answers",{prev:!!e(a)}]),style:C({top:(e(a)?-m.value:0)+"px",opacity:e(a)?0:1})},[(v(!0),y(q,null,K(e(d),(i,p)=>(v(),y("div",{key:p,class:"answer button-frame",onClick:c=>g.onSelect(i)},[t("p",null,b(i.text[e(I).lang]),1)],8,ve))),128))],6),t("div",{ref_key:"subAnswersEl",ref:x,class:A(["answers",{next:!e(a)}]),style:C({top:(e(a)?0:m.value)+"px",opacity:e(a)?1:0})},[(v(!0),y(q,null,K(e(a),(i,p)=>(v(),y("div",{key:p,class:A(["answer button-frame",[p%2==0?"even":"odd"]]),onClick:c=>g.onSelect(i)},[t("p",null,b(i.text[e(I).lang]),1)],10,xe))),128))],6)],4)],2))}});const Ae={class:"persona-answers"},fe={class:"others"},he={class:"number current"},ye={class:"current"},ge=V({__name:"PersonaAnswersPage",setup(g){const w=L(),I=E(w.progressData.personaHistory),_=N.length*2,f=o(()=>I.value.length),S=o(()=>Math.ceil(f.value/2)),l=o(()=>I.value[f.value-1]||null),P=o(()=>l.value?Y[l.value.questionId]:null),h=o(()=>{const u=[];return I.value.forEach(d=>{const{questionId:a,selectedAnswerIdx:n}=d;u.push(a),n!=null&&u.push(a+"."+n)}),u}),H=o(()=>f.value==_);J(l,u=>{if(u&&u.selectedAnswerIdx==null)return;let d=0;const a=P.value&&P.value.subs!=null;d=Math.floor(f.value/2);let n;if(a){const x=P.value,m=l.value.selectedAnswerIdx;n=x.subs[m]}else{const x=N[d];if(!x)return;if(x.length==1)n=x[0];else{const m=x.filter(M=>!(M.prereqs&&M.prereqs.some(s=>!s.some(r=>h.value.includes(r)))));n=m[se.random(m.length-1)]}}w.addPersonaStep({questionId:n.id})},{immediate:!0,deep:!0});function O(u){var d;if(w.selectPersonaAnswer(u.idx),H.value&&l.value.selectedAnswerIdx!=null){const a=z.currentRoute.value.name,n=(d=te[a].meta.flow.next)==null?void 0:d.page;z.replace({name:n})}}return $(()=>{H.value&&delete l.value.selectedAnswerIdx}),(u,d)=>(v(),y("div",Ae,[t("div",{class:"page-frame",style:C({"border-image-source":e(ee)("bg-frame-1")})},null,4),t("div",{class:"steps-container",style:C({top:"-"+(e(S)-1)*1.5*100+"vh"})},[(v(!0),y(q,null,K(e(w).progressData.personaHistory,(a,n)=>(v(),y(q,null,[n%2==0&&Math.abs(e(S)-(n/2+1))<=1?(v(),W(me,{key:n,"main-step-idx":n,"idx-offset":n/2-e(S)+1,"on-select":O,style:C({top:n/2*1.5*100+"vh"})},null,8,["main-step-idx","idx-offset","style"])):D("",!0)],64))),256))],4),t("div",fe,[t("div",he,[t("span",ye,b(Math.min(e(f),_)),1),t("span",{class:"all"},"/"+b(_))])])]))}});const be=ne(ge,[["__scopeId","data-v-aca4903c"]]);export{be as default};
