import{d as G,c as L,o as R,a as M,e,_ as j,y as I,h as P,t as _,b as K,s as Q,v as F,B as re,A as ie,w as ce,G as V,k as Z,H as x,N as ee,u as i,x as y,F as X,i as te,D as U,L as T,m as se,O as de,q as pe}from"./index-6afd404f.js";import{_ as ue}from"./PageContainer.vue_vue_type_style_index_0_lang-43416dd9.js";import{_ as fe}from"./SpriteSheetImg.vue_vue_type_script_setup_true_lang-a13ffabd.js";import{i as oe}from"./images-abe68057.js";const he={class:"result-image"},_e={class:"picture"},ge=["src","alt"],ye=G({__name:"ResultImage",props:{persona:{}},setup(t){const a=t,o="./imgs",d=L(()=>a.persona?o+"/persona-"+a.persona.id+".webp":null);return(n,r)=>{var f;return R(),M("div",he,[e("div",_e,[e("img",{class:"part-large persona",src:d.value,alt:(f=n.persona)==null?void 0:f.root},null,8,ge)])])}}});const ae=j(ye,[["__scopeId","data-v-ed7e98b6"]]),ve={class:"part-container"},be={class:"part-circle"},me=G({__name:"ResultPart",props:{partTypeLabelStyle:{},partLabelStyle:{},archCoords:{},src:{},part:{default:""},label:{default:""},imgScale:{default:1}},setup(t){return(a,o)=>(R(),M("div",ve,[e("div",be,[e("div",{class:"part",style:I({transform:"scale("+a.imgScale+")"})},[P(fe,{src:a.src,alt:a.part,"x-sprites":3,"y-sprites":4,x:a.archCoords.x,y:a.archCoords.y},null,8,["src","alt","x","y"])],4)]),e("span",{style:I(a.partLabelStyle)},_(a.label),5)]))}});const le=j(me,[["__scopeId","data-v-7c915efe"]]);function Se(t,a){return new Promise((o,d)=>{t.onload=()=>o(t.height),t.onerror=d,t.src=a})}async function ne(t,a,o,d=1){var k,$,l,s,p,g,w,H,E,A,W,Y;const n=o.getBoundingClientRect(),r=(n.x-a.x)*d,f=(n.y-a.y)*d,u=n.width*d,v=n.height*d,c=o.style;if(c.opacity==="0")return;const m=(k=c.filter)==null?void 0:k.toString();if(m&&(t.filter=m),c.boxShadow&&c.boxShadow.length){const b=c.boxShadow.replace(/, /g,",").split(" ");t.shadowColor=b[0],t.shadowOffsetX=D(b[1]),t.shadowOffsetY=D(b[2]),t.shadowBlur=D(b[3])}if(o.childElementCount==1&&(($=c.overflow)==null?void 0:$.toString())=="hidden"){const b=o.children[0];if(b.tagName=="IMG"){const h=b.getBoundingClientRect(),{naturalWidth:C,naturalHeight:S}=b,B=C*n.width/h.width,N=S*n.height/h.height,O=C*(n.x-h.x)/h.width,z=S*(n.y-h.y)/h.height;t.drawImage(b,O,z,B,N,r,f,u,v)}}else{if(u&&v){let h;switch(o.tagName){case"IMG":h=o,t.drawImage(h,r,f,u,v);return;case"DIV":let C=!1;const S=(l=c.backgroundColor)==null?void 0:l.toString();S&&S!="rgba(0, 0, 0, 0)"&&(C=!0);const B=(s=c.borderWidth)==null?void 0:s.toString();B&&B!="0px"&&(t.strokeStyle=B.toString()||"black",C=!0),(p=c.maskImage)==null||p.toString();const N=(g=c.backgroundImage)==null?void 0:g.toString();if(C){const O=Number.parseFloat(((w=c.borderRadius)==null?void 0:w.toString())||"0");if(O)we(t,r,f,u,v,u*O),t.fillStyle=S,t.fill();else if(t.fillStyle=S,t.fillRect(r,f,u,v),N){const z=new Image(u,v);await Se(z,N.replace(/url|\(|\)|"/g,"")),t.drawImage(z,r,f,u,v)}t.fillStyle="none"}break}}const{innerText:b}=o;if(!o.childElementCount&&b&&b.length){t.fillStyle=((H=c.color)==null?void 0:H.toString())||"black";const h=D(c.fontSize)*40,C=[(E=c.fontStyle)==null?void 0:E.toString(),(A=c.fontWeight)==null?void 0:A.toString(),h+"px",(W=c.fontFamily)==null?void 0:W.toString()].join(" ");t.font=C,t.textAlign=((Y=c.textAlign)==null?void 0:Y.toString())||"left";let S=0;switch(t.textAlign){case"center":S=u/2;break;case"right":S=u;break}t.fillText(b,r+S,f+h,u),t.fillStyle="none"}if(t.shadowColor="rgba(0,0,0,0)",o.childElementCount)for(let h=0;h<o.children.length;h++)await ne(t,a,o.children[h],d)}t.filter="none"}function D(t){return t=t.replace("px",""),parseFloat(t)}function we(t,a,o,d,n,r){return d<2*r&&(r=d/2),n<2*r&&(r=n/2),t.beginPath(),t.moveTo(a+r,o),t.arcTo(a+d,o,a+d,o+n,r),t.arcTo(a+d,o+n,a,o+n,r),t.arcTo(a,o+n,a,o,r),t.arcTo(a,o,a+d,o,r),t.closePath(),t}const Ie={ref:"contentEl",class:"shared-image"},ke={class:"button-container"},Le={class:"content"},Re={class:"section"},Ce={class:"intro"},Te=["innerHTML"],$e={class:"parts"},He={class:"section"},Pe={class:"canvas-container hidden"},q=1080,J=1920,Me=G({__name:"SharedImage",props:{persona:{},bodyStyle:{},personaLabelStyle:{},personaPartLabelStyle:{},introStyle:{}},setup(t){K(),Q();const a=t,o=L(()=>se[a.persona.id]),d=F(null),n=F(""),r=F(null),f=F(!1);function u(l,s){if(l.tagName=="IMG")s.push(l);else for(let p=0;p<l.children.length;p++)u(l.children[p],s)}re(()=>{ie(()=>{const l=[];u(r.value,l);const s=setInterval(()=>{for(let p=0;p<l.length;p++){const g=l[p];g!=null&&g.complete&&g.naturalHeight&&(l.splice(p,1),p--)}l.length||(clearInterval(s),f.value=!0)},1e3)})}),ce(f,(l,s)=>{!s&&l&&v()});async function v(){const l=d.value,s=l.getContext("2d"),p=r.value.getBoundingClientRect(),g=p.width,w=l.clientWidth/g;s&&(await ne(s,p,r.value,w),s.globalCompositeOperation="destination-over",s.fillStyle="white",s.fillRect(0,0,l.clientWidth,l.clientHeight),n.value=l.toDataURL("image/png;base64"))}const c=F(!1);c.value=!0;const m={color:"black",fontFamily:"Red Rose",fontWeight:"bold",fontSize:"0.8em",textAlign:"center",width:"100%"},k=Object.assign({},m,{fontWeight:"normal",fontFamily:"Arsenal"}),$=Object.assign({},m,{fontSize:"1em"});return(l,s)=>{var p,g;return R(),M("div",Ie,[e("div",ke,[P(x,{class:"cta",dark:"",disabled:!f.value,download:"Ourchetype.png",href:n.value},{default:V(()=>[...s[0]||(s[0]=[Z(" Share ",-1)])]),_:1},8,["disabled","href"])]),e("div",{ref_key:"canvasSourceEl",ref:r,class:"canvas-source hidden",style:I({width:q+"px",height:J+"px"})},[e("div",Le,[s[4]||(s[4]=e("img",{class:"logo",src:ee},null,-1)),e("div",Re,[e("div",Ce,[e("p",{style:I(l.introStyle)},_(i(y)("intro")),5)]),e("h2",{style:I(l.personaLabelStyle)},_((p=o.value)==null?void 0:p.label),5),P(ae,{class:"persona",persona:l.persona},null,8,["persona"]),e("p",{style:I(l.bodyStyle),innerHTML:i(y)("persona-2")},null,12,Te),e("div",$e,[(R(!0),M(X,null,te((g=o.value)==null?void 0:g.archs,(w,H)=>(R(),U(le,{key:H,"part-type-label-style":l.personaPartLabelStyle,"part-label-style":l.personaPartLabelStyle,"arch-coords":i(oe)[w],src:"archs.webp",part:"persona",label:i(T)[w].root},null,8,["part-type-label-style","part-label-style","arch-coords","label"]))),128))])]),e("div",He,[e("p",{style:I(i($))},_(i(y)("title")),5),e("p",{style:m},_(i(y)("subtitle")),1),s[1]||(s[1]=e("div",null,null,-1)),s[2]||(s[2]=e("div",null,null,-1)),s[3]||(s[3]=e("div",null,null,-1)),e("p",{style:I(i(k))},_(i(y)("place")),5),e("p",{style:m},_(i(y)("date")),1)]),e("p",{style:I(i(k))},"ourchetype.com",4)])],4),e("div",Pe,[e("canvas",{ref_key:"canvasEl",ref:d,width:q,height:J},null,512)])],512)}}});const Ee=j(Me,[["__scopeId","data-v-19b115f5"]]),Ae={class:"section"},Be={class:"intro"},Fe=["innerHTML"],We={class:"parts"},Ne={class:"section"},Oe=["innerHTML"],ze={class:"bottom"},De={class:"bottom-inner"},Ge={class:"section"},je={class:"self-label"},Ve={class:"boxed"},Xe={class:"section"},Ue={class:"self-event"},Ye=["innerHTML"],qe={class:"section"},Je=["innerHTML"],Ke=G({__name:"ResultPage",setup(t){const a=K(),o=Q(),d=de();L(()=>o.lang),L(()=>d.regData.name);const n=L(()=>a.resultData.topArchetypes),r=L(()=>n.value.persona?T[n.value.persona]:T.Ev),f=L(()=>se[r.value.id]),u=L(()=>n.value.self?T[n.value.self]:T.Ev),v=L(()=>n.value.shadow?T[n.value.shadow]:T.Ev),c={color:"black",fontFamily:"Arsenal",fontSize:"1.2em",textAlign:"center",width:"100%"},m={color:"black",fontFamily:"Red Rose",fontWeight:"bold",fontSize:"2.8em",textAlign:"center",lineHeight:"150%"},k=Object.assign({},m,{fontSize:"1em"}),$=Object.assign({},c,{fontSize:"1.2em"});return(l,s)=>(R(),U(ue,{"inner-class":{result:!0}},{default:V(()=>{var p,g,w,H,E;return[s[3]||(s[3]=e("img",{class:"logo",src:ee,alt:"Matra Cita"},null,-1)),e("div",Ae,[e("div",Be,[e("p",{style:I(i($))},_(i(y)("intro")),5)]),e("h2",{style:m},_((p=f.value)==null?void 0:p.label),1),P(ae,{persona:r.value,style:{width:"70vw"}},null,8,["persona"]),e("p",{style:c,innerHTML:i(y)("persona-2")},null,8,Fe),e("div",We,[(R(!0),M(X,null,te((g=f.value)==null?void 0:g.archs,(A,W)=>(R(),U(le,{key:W,"part-type-label-style":i(k),"part-label-style":i(k),"arch-coords":i(oe)[A],src:"archs.webp",part:"persona",label:i(T)[A].root},null,8,["part-type-label-style","part-label-style","arch-coords","label"]))),128))]),e("div",Ne,[e("p",{innerHTML:i(y)("persona-3")},null,8,Oe)]),P(Ee,{persona:r.value,"body-style":c,"persona-label-style":m,"persona-part-label-style":i(k),"intro-style":i($)},null,8,["persona","persona-part-label-style","intro-style"])]),e("div",ze,[e("div",De,[e("div",Ge,[e("p",null,_(i(y)("self-1")),1),e("h3",je,_((w=u.value.self.group)==null?void 0:w.label),1),e("p",Ve,_(i(y)("self-2")),1)]),e("div",Xe,[e("p",null,_(i(y)("self-3")),1),e("h3",Ue,_((H=u.value.self.group)==null?void 0:H.event),1),e("p",{class:"boxed",innerHTML:(E=u.value.self.group)==null?void 0:E.eventInfo},null,8,Ye)]),s[1]||(s[1]=e("div",{class:"spacer"},null,-1)),e("div",qe,[e("p",null,_(i(y)("shadow-1")),1),e("h3",{class:"shadow-label",innerHTML:v.value.shadow.label},null,8,Je),v.value.shadow.url?(R(),M(X,{key:0},[e("p",null,_(i(y)("shadow-2")),1),P(x,{class:"shadow-button",external:"",href:v.value.shadow.url||void 0,outline:"",color:"white","bg-color":"black","no-shadow":""},{default:V(()=>[...s[0]||(s[0]=[Z(" Shadow ",-1)])]),_:1},8,["href"])],64)):pe("",!0)]),s[2]||(s[2]=e("div",null,null,-1))])])]}),_:1}))}});const tt=j(Ke,[["__scopeId","data-v-b9741839"]]);export{tt as default};
