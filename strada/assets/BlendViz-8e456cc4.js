var $=Object.defineProperty;var x=(i,e,t)=>e in i?$(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var c=(i,e,t)=>(x(i,typeof e!="symbol"?e+"":e,t),t);import{A as m,y as u,d as I,o as p,a as w,e as a,z as y,t as _,B as P,n as D,p as N,i as F,_ as k,C as L,D as M,E as B,b as O,c as g,F as j,q as H,u as v,h as K,w as Q,m as U,v as f,k as G}from"./index-a8951481.js";import{a as J,s as R}from"./math-62bd5f2f.js";import{B as X}from"./BasicButton-09dc138b.js";import{q as Y}from"./questions-b47298ad.js";class Z{constructor(e,t){c(this,"addWeightInterval");c(this,"interval",200);c(this,"increment",.2);c(this,"weights");c(this,"fixedConfig");c(this,"sourceConfigs");c(this,"mergedConfig");c(this,"resultConfig",null);this.fixedConfig=e,this.sourceConfigs=t,this.mergedConfig=m.cloneDeep(t[Number(Object.keys(t)[0])]),this.weights=u({});const n=1/Object.keys(t).length;for(const o in t){const r=o;this.weights.value[r]=n}}startAddWeight(e){const{interval:t}=this;this.addWeightInterval==null&&(this.addWeight(e),this.addWeightInterval=window.setInterval(()=>this.addWeight(e),t))}stopAddWeight(){this.addWeightInterval!=null&&(clearInterval(this.addWeightInterval),this.addWeightInterval=void 0)}addWeight(e){const{weights:t,increment:n}=this;t.value[e]+=n;for(const o in t.value)t.value[o]/=1+n;this.applyWeights()}applyWeights(){J(this.mergedConfig,this.sourceConfigs,this.weights.value),this.resultConfig&&m.merge(this.resultConfig,this.mergedConfig)}}const W=i=>(N("data-v-24864a90"),i=i(),F(),i),ee=W(()=>a("div",{class:"outer"},null,-1)),te=["onTouchstart"],se=W(()=>a("div",{class:"back"},null,-1)),ie={class:"center"},ne={class:"weight"},oe=I({__name:"BlendPipe",props:{color:{},width:{},weight:{},onTouchStart:{type:Function},onTouchEnd:{type:Function},isActive:{type:Boolean}},setup(i){const e=i;function t(){window.addEventListener("touchend",n),e.onTouchStart()}function n(){window.removeEventListener("touchend",n),e.onTouchEnd()}return(o,r)=>(p(),w("div",{class:D(["blend-pipe",{active:o.isActive}]),style:y({width:(.3+o.weight*.7)*o.width+"%"})},[ee,a("div",{class:"inner",style:y({backgroundColor:o.color})},null,4),a("div",{class:"button",onTouchstart:P(t,["prevent"])},[se,a("div",ie,[a("div",ne,_(Math.round(o.weight*10)),1)])],40,te)],6))}});const ae=k(oe,[["__scopeId","data-v-24864a90"]]),le={class:"blend-viz"},ce={class:"pipes"},de={class:"instructions"},re={class:"i1"},ue={class:"i2"},he=["id"],ge={class:"button-container"},ve=I({__name:"BlendViz",props:{elId:{},fixedConfig:{},componentConfigs:{},questionSettings:{},pipeColors:{},maskSrc:{},particlesStyle:{}},setup(i){const e=i,t=u(null),n=new Z(e.fixedConfig,e.componentConfigs);L(()=>{window.tsParticles.load(e.elId,e.fixedConfig).then(l=>{var d;t.value=l,n.resultConfig=(d=t.value)==null?void 0:d.actualOptions,n.applyWeights()})}),M(()=>{t.value&&t.value.destroy()});const o=u(null);B(o,s=>{s!=null?n.startAddWeight(s):n.stopAddWeight()});const r=O(),C=g(()=>n.weights.value),S=u(Y[e.questionSettings.areaIdx][e.questionSettings.questionIdx]),b=g(()=>S.value.answers),T=g(()=>{const s={};for(let l=0;l<b.value.length;l++)s[l]=b.value[l].scores;return s}),z=r.progress.scores,A=g(()=>r.getQuestionHistory(e.questionSettings)),E=u(A.value.ss),q=m.debounce(V,1e3,{trailing:!0});B(C,()=>q(),{immediate:!0,deep:!0});function V(){const s=E.value;R(z,s,T.value,C.value);for(const l in s){const d=l;s[d]*=S.value.weight}}return(s,l)=>(p(),w("div",le,[a("div",ce,[(p(!0),w(j,null,H(v(n).weights.value,(d,h)=>(p(),U(ae,{key:h,onTouchStart:()=>o.value=Number(h),onTouchEnd:()=>o.value=null,color:s.pipeColors[h],width:10,weight:d,isActive:h==o.value},null,8,["onTouchStart","onTouchEnd","color","weight","isActive"]))),128))]),a("div",de,[a("div",re,_(v(f)("see instructions","general")),1),a("div",ue,_(v(f)("1")),1)]),a("div",{id:s.elId,class:"particles",style:y([{"mask-image":`url(imgs/blend-viz/${s.maskSrc})`,"-webkit-mask-image":`url(imgs/blend-viz/${s.maskSrc})`},s.particlesStyle])},null,12,he),a("div",ge,[K(X,{replace:""},{default:Q(()=>[G(_(v(f)("continue","general")),1)]),_:1})])]))}});const ye=k(ve,[["__scopeId","data-v-dd4f9e19"]]);export{ye as B};
