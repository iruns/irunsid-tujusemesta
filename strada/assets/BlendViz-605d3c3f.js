var P=Object.defineProperty;var D=(o,e,t)=>e in o?P(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var l=(o,e,t)=>(D(o,typeof e!="symbol"?e+"":e,t),t);import{A as m,y as c,d as W,o as v,a as y,e as n,z as w,B as I,n as N,p as x,i as F,_ as T,C as O,D as j,E as k,b as M,c as g,F as H,q as K,u as p,t as _,h as L,w as Q,m as U,v as f,k as G}from"./index-5b0ea52c.js";import{a as J,s as R}from"./math-18f78e4d.js";import{B as X}from"./BasicButton-5fe51ee4.js";import{q as Y}from"./questions-b94d34e1.js";class Z{constructor(e,t){l(this,"addWeightInterval");l(this,"interval",200);l(this,"increment",.2);l(this,"weights");l(this,"fixedConfig");l(this,"sourceConfigs");l(this,"mergedConfig");l(this,"resultConfig",null);this.fixedConfig=e,this.sourceConfigs=t,this.mergedConfig=m.cloneDeep(t[Number(Object.keys(t)[0])]),this.weights=c({});const i=1/Object.keys(t).length;for(const r in t){const u=r;this.weights.value[u]=i}}startAddWeight(e){const{interval:t}=this;this.addWeightInterval==null&&(this.addWeight(e),this.addWeightInterval=window.setInterval(()=>this.addWeight(e),t))}stopAddWeight(){this.addWeightInterval!=null&&(clearInterval(this.addWeightInterval),this.addWeightInterval=void 0)}addWeight(e){const{weights:t,increment:i}=this;t.value[e]+=i;for(const r in t.value)t.value[r]/=1+i;this.applyWeights()}applyWeights(){J(this.mergedConfig,this.sourceConfigs,this.weights.value),this.resultConfig&&m.merge(this.resultConfig,this.mergedConfig)}}const C=o=>(x("data-v-e20c2b44"),o=o(),F(),o),ee=C(()=>n("div",{class:"outer"},null,-1)),te=C(()=>n("div",{class:"back"},null,-1)),se=C(()=>n("div",{class:"center"},null,-1)),ie=[te,se],oe=W({__name:"BlendPipe",props:{color:{},width:{},weight:{},onTouchStart:{type:Function},onTouchEnd:{type:Function},isActive:{type:Boolean}},setup(o){return(e,t)=>(v(),y("div",{class:N(["blend-pipe",{active:e.isActive}]),style:w({width:(.3+e.weight*.7)*e.width+"%"})},[ee,n("div",{class:"inner",style:w({backgroundColor:e.color})},null,4),n("div",{class:"button",onTouchstart:t[0]||(t[0]=I((...i)=>e.onTouchStart&&e.onTouchStart(...i),["prevent"])),onTouchend:t[1]||(t[1]=I((...i)=>e.onTouchEnd&&e.onTouchEnd(...i),["prevent"]))},ie,32)],6))}});const ne=T(oe,[["__scopeId","data-v-e20c2b44"]]),ae={class:"blend-viz"},le={class:"pipes"},re={class:"instructions"},de={class:"i1"},ce={class:"i2"},ue=["id"],he={class:"button-container"},ge=W({__name:"BlendViz",props:{elId:{},fixedConfig:{},componentConfigs:{},questionSettings:{},pipeColors:{},maskSrc:{},particlesStyle:{}},setup(o){const e=o,t=c(null),i=new Z(e.fixedConfig,e.componentConfigs);O(()=>{window.tsParticles.load(e.elId,e.fixedConfig).then(a=>{var d;t.value=a,i.resultConfig=(d=t.value)==null?void 0:d.actualOptions,i.applyWeights()})}),j(()=>{t.value&&t.value.destroy()});const r=c(null);k(r,s=>{s!=null?i.startAddWeight(s):i.stopAddWeight()});const u=M(),S=g(()=>i.weights.value),b=c(Y[e.questionSettings.areaIdx][e.questionSettings.questionIdx]),B=g(()=>b.value.answers),z=g(()=>{const s={};for(let a=0;a<B.value.length;a++)s[a]=B.value[a].scores;return s}),A=u.progress.scores,q=g(()=>u.getQuestionHistory(e.questionSettings)),E=c(q.value.ss),V=m.debounce($,1e3,{trailing:!0});k(S,()=>V(),{immediate:!0,deep:!0});function $(){const s=E.value;R(A,s,z.value,S.value);for(const a in s){const d=a;s[d]*=b.value.weight}}return(s,a)=>(v(),y("div",ae,[n("div",le,[(v(!0),y(H,null,K(p(i).weights.value,(d,h)=>(v(),U(ne,{key:h,onTouchStart:()=>r.value=Number(h),onTouchEnd:()=>r.value=null,color:s.pipeColors[h],width:10,weight:d,isActive:h==r.value},null,8,["onTouchStart","onTouchEnd","color","weight","isActive"]))),128))]),n("div",re,[n("div",de,_(p(f)("see instructions","general")),1),n("div",ce,_(p(f)("1")),1)]),n("div",{id:s.elId,class:"particles",style:w([{"mask-image":`url(imgs/blend-viz/${s.maskSrc})`,"-webkit-mask-image":`url(imgs/blend-viz/${s.maskSrc})`},s.particlesStyle])},null,12,ue),n("div",he,[L(X,{replace:""},{default:Q(()=>[G(_(p(f)("continue","general")),1)]),_:1})])]))}});const ye=T(ge,[["__scopeId","data-v-dd4f9e19"]]);export{ye as B};
