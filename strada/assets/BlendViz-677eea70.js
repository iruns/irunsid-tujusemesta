var E=Object.defineProperty;var $=(i,e,t)=>e in i?E(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var r=(i,e,t)=>($(i,typeof e!="symbol"?e+"":e,t),t);import{B as w,y as d,d as I,o as v,c as y,a,A as u,t as _,C as P,e as D,p as N,g as x,_ as B,D as F,E as L,G as C,b as M,k as g,z as O,F as j,m as G,u as p,f as H,w as K,l as Q,s as f,i as U}from"./index-7916ba3f.js";import{a as J,s as R}from"./math-c3d3a642.js";import{B as X}from"./BasicButton-75aa92a7.js";class Y{constructor(e){r(this,"addWeightInterval");r(this,"interval",200);r(this,"increment",.2);r(this,"weights");r(this,"sourceConfigs");r(this,"mergedConfig");r(this,"resultConfig",null);this.sourceConfigs=e,this.mergedConfig=w.cloneDeep(e[Number(Object.keys(e)[0])]),this.weights=d({});const t=1/Object.keys(e).length;for(const n in e){const o=n;this.weights.value[o]=t}}startAddWeight(e){const{interval:t}=this;this.addWeightInterval==null&&(this.addWeight(e),this.addWeightInterval=window.setInterval(()=>this.addWeight(e),t))}stopAddWeight(){this.addWeightInterval!=null&&(clearInterval(this.addWeightInterval),this.addWeightInterval=void 0)}addWeight(e){const{weights:t,increment:n}=this;t.value[e]+=n;for(const o in t.value)t.value[o]/=1+n;this.applyWeights()}applyWeights(){J(this.mergedConfig,this.sourceConfigs,this.weights.value),this.resultConfig&&w.merge(this.resultConfig,this.mergedConfig)}}const Z=i=>(N("data-v-f6f756a3"),i=i(),x(),i),ee=["onTouchstart"],te=Z(()=>a("div",{class:"back"},null,-1)),se={class:"center"},ie={class:"weight"},ne=I({__name:"BlendPipe",props:{color:{},width:{},weight:{},onTouchStart:{type:Function},onTouchEnd:{type:Function},isActive:{type:Boolean}},setup(i){const e=i;function t(){window.addEventListener("touchend",n),e.onTouchStart()}function n(){window.removeEventListener("touchend",n),e.onTouchEnd()}return(o,m)=>(v(),y("div",{class:D(["blend-pipe",{active:o.isActive}]),style:u({width:(.3+o.weight*.7)*o.width+"%"})},[a("div",{class:"outer",style:u({"mask-image":"url(imgs/blend-viz/blend-pipe.webp)","-webkit-mask-image":"url(imgs/blend-viz/blend-pipe.webp)"})},null,4),a("div",{class:"inner",style:u({backgroundColor:o.color})},null,4),a("div",{class:"button",onTouchstart:P(t,["prevent"])},[te,a("div",se,[a("div",ie,_(Math.round(o.weight*10)),1)])],40,ee)],6))}});const oe=B(ne,[["__scopeId","data-v-f6f756a3"]]),ae={class:"blend-viz"},le={class:"pipes"},re={class:"instructions"},ce={class:"i1"},de={class:"i2"},ue=["src"],he=["id"],ge={class:"button-container"},pe=I({__name:"BlendViz",props:{elId:{},fixedConfig:{},componentConfigs:{},questionSettings:{},pipeColors:{},maskSrc:{},particlesStyle:{}},setup(i){const e=i,t=d(null),n=new Y(e.componentConfigs);F(()=>{window.tsParticles.load(e.elId,e.fixedConfig).then(l=>{var c;t.value=l,n.resultConfig=(c=t.value)==null?void 0:c.actualOptions,n.applyWeights()})}),L(()=>{t.value&&t.value.destroy()});const o=d(null);C(o,s=>{s!=null?n.startAddWeight(s):n.stopAddWeight()});const m=M(),b=g(()=>n.weights.value),S=d(O[e.questionSettings.areaIdx][e.questionSettings.questionIdx]),k=g(()=>S.value.answers),W=g(()=>{const s={};for(let l=0;l<k.value.length;l++)s[l]=k.value[l].scores;return s}),z=m.progress.scores,q=g(()=>m.getQuestionHistory(e.questionSettings.areaIdx,e.questionSettings.questionIdx)),T=d(q.value.ss),V=w.debounce(A,1e3,{trailing:!0});C(b,()=>V(),{immediate:!0,deep:!0});function A(){const s=T.value;R(z,s,W.value,b.value);for(const l in s){const c=l;s[c]*=S.value.weight}}return(s,l)=>(v(),y("div",ae,[a("div",le,[(v(!0),y(j,null,G(p(n).weights.value,(c,h)=>(v(),Q(oe,{key:h,"on-touch-start":()=>o.value=Number(h),"on-touch-end":()=>o.value=null,color:s.pipeColors[h],width:10,weight:c,"is-active":h==o.value},null,8,["on-touch-start","on-touch-end","color","weight","is-active"]))),128))]),a("div",re,[a("div",ce,_(p(f)("see instructions","general")),1),a("div",de,_(p(f)("1")),1)]),a("img",{class:"particles-mask-img",style:u(s.particlesStyle),src:`imgs/blend-viz/${s.maskSrc}`},null,12,ue),a("div",{id:s.elId,class:"particles",style:u([{"mask-image":`url(imgs/blend-viz/${s.maskSrc})`,"-webkit-mask-image":`url(imgs/blend-viz/${s.maskSrc})`},s.particlesStyle])},null,12,he),a("div",ge,[H(X,{replace:""},{default:K(()=>[U(_(p(f)("continue","general")),1)]),_:1})])]))}});const we=B(pe,[["__scopeId","data-v-466e1841"]]);export{we as B};
