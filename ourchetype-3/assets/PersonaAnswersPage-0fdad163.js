import{f as F,g as o,o as h,a as p,d as r,i as B,h as l,w as C,a6 as G,a9 as R,F as L,y as E,v as N,t as $,aa as Z,ab as ee,l as se,u as te,r as P,a7 as Q,x as V,a3 as ae,n as j,s as ne,j as oe,ac as b,ad as z,ae as re,q as le,P as ce,p as ie,b as ue,_ as de}from"./index-26994c33.js";import{S as he,_ as fe}from"./PageContainer.vue_vue_type_style_index_0_lang-f09e4c63.js";const pe=""+new URL("persona-answers-5f4217e2.webp",import.meta.url).href,ve={class:"question-sign"},Se=r("p",{class:"instruction"}," Lihat pertanyaan di bentuk ini ",-1),_e={class:"shape"},ge={class:"answers"},me=r("img",{class:"circles",src:pe},null,-1),we={class:"texts"},xe=["onClick"],ye=F({__name:"PersonaStepSet",props:{historyStep:null,idxOffset:{default:0},stepState:{default:"question"},onNext:{type:Function,default:()=>{}},onSelect:null,isLast:{type:Boolean,default:!1}},setup(n){const k=n,i=o(()=>Z[k.historyStep.answerSet.question]),x=o(()=>ee([...k.historyStep.answerSet.answers]));return(u,M)=>(h(),p("div",{class:N(["step-set",n.idxOffset?n.idxOffset==1?"next-1 question-state":n.idxOffset==-1?"prev-1 answers-state":!1:"active "+n.stepState+"-state",n.isLast?"last":""])},[r("div",ve,[Se,r("div",_e,[B(he,{src:"persona-shapes.webp","x-sprites":2,"y-sprites":3,x:l(i).x,y:l(i).y},null,8,["x","y"])]),B(R,{class:"cta",onClick:n.onNext},{default:C(()=>[G(" Lanjut ")]),_:1},8,["onClick"])]),r("div",ge,[me,r("div",we,[(h(!0),p(L,null,E(l(x),(c,v)=>(h(),p("div",{key:v,class:N(["answer",v%2==0?"even":"odd"])},[r("p",{onClick:S=>n.onSelect(c)},$(c.text),9,xe)],2))),128))])])],2))}});const Ae=n=>(ie("data-v-f5dd41e2"),n=n(),ue(),n),Pe={class:"persona-answers"},Be={class:"number current"},ke={class:"current"},qe={class:"all"},be=Ae(()=>r("p",{class:"instruction"},"Selesai di Ruang Terang",-1)),Ce=F({__name:"PersonaAnswersPage",setup(n){const i=se(),x=te(),u=P(i.progress.personaHistory),M=o(()=>{const e={};return u.value.map(a=>e[a.answerSet.id]=!0),e}),c=o(()=>u.value.length),v=o(()=>u.value[c.value-1]||null),S=P("question"),_=o(()=>S.value=="question"&&c.value==b+1),y=o(()=>{let e=0,a=z[e];for(;c.value>a.until;)e++,a=z[e];return a}),I=o(()=>i.progress.personaScoresSum),g=P([]);for(let e=0;e<Q.length;e++){const a=Q[e].id;g.value.push({arch:a,score:I.value[a]||0,idx:e})}const m=o(()=>{const e=y.value.focusBetween;for(let s=0;s<g.value.length;s++){const t=g.value[s];t.score=I.value[t.arch]||0}const a=[...g.value];return a.sort((s,t)=>s.score==t.score?Math.random()-.5:s.score>t.score?-1:1),a.slice(0,e)}),H=o(()=>{let e=0;const a=m.value;for(let s=0;s<a.length;s++){const t=a[s];e+=t.score}return e/=a.length,a.filter(s=>s.score<e).sort((s,t)=>s.idx<t.idx?-1:1)}),w=o(()=>(m.value.length==g.value.length,re.filter(a=>!(a.question==U.value||M.value[a.id])))),f=P([]);function D(){f.value=[...w.value],y.value.contrastMult&&(y.value.contrastMult>0?f.value.sort((s,t)=>s.contrast<t.contrast?1:-1):y.value.contrastMult<0&&f.value.sort((s,t)=>s.contrast>t.contrast?1:-1));for(let s=0;s<w.value.length;s++){const t=w.value[s];t.fitness=0;for(let d=0;d<m.value.length;d++){const A=m.value[d];t.fitness+=(t.sumScores[A.arch]||0)*-A.score}}f.value.sort((s,t)=>s.fitness>t.fitness?-1:1);const e=H.value.length>1?H.value:m.value;if(e.length>1){for(let s=0;s<w.value.length;s++){const t=w.value[s];if(t.fitness=0,e.length)for(let d=0;d<e.length;d++){const A=e[d].arch,O=t.contrasts[A];if(O)for(let q=0;q<e.length;q++){const X=e[q].arch;t.fitness+=O[X]||0}}}f.value.sort((s,t)=>s.fitness>t.fitness?-1:1)}const a=f.value[0];a&&i.addPersonaStep({answerSet:a})}const U=o(()=>u.value.length?u.value[u.value.length-1].answerSet.question:null),Y=o(()=>!_.value&&(!v.value||!!v.value.selectedScores));V(Y,(e,a)=>{e!=a&&e&&D()},{immediate:!0});function J(){S.value="answers"}function K(e){i.selectPersonaAnswer(e.scores),S.value="question"}function W(){i.selectPersona(),le.replace({name:ce.PersonaToSideRoom})}V(_,(e,a)=>{e!=a&&T()},{immediate:!0}),ae(()=>T(!0));function T(e=!1){_.value?setTimeout(()=>{x.setBGSetting({logoSize:.5,headerY:.5})},e?0:800):x.setBGSetting({})}return(e,a)=>(h(),p("div",Pe,[r("div",{class:"steps-container",style:j({top:"-"+(l(c)-1)*1.5*100+"vh"})},[(h(!0),p(L,null,E(l(i).progress.personaHistory,(s,t)=>(h(),p(L,null,[Math.abs(l(c)-(t+1))<=1?(h(),ne(ye,{key:t,"history-step":s,"idx-offset":t-l(c)+1,"step-state":S.value,"on-next":J,"on-select":K,"is-last":l(_),style:j({top:t*1.5*100+"vh"})},null,8,["history-step","idx-offset","step-state","is-last","style"])):oe("",!0)],64))),256))],4),r("div",{class:N(["others",{last:l(_)}])},[r("div",Be,[r("span",ke,$(Math.min(l(c),l(b))),1),r("span",qe,"/"+$(l(b)),1)]),B(fe,{"outer-class":{closing:!0}},{default:C(()=>[be,B(R,{class:"cta",onClick:W},{default:C(()=>[G(" Lanjut ")]),_:1})]),_:1})],2)]))}});const $e=de(Ce,[["__scopeId","data-v-f5dd41e2"]]);export{$e as default};
