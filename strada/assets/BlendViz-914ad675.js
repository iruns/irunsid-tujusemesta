var E=Object.defineProperty;var P=(i,e,t)=>e in i?E(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var c=(i,e,t)=>(P(i,typeof e!="symbol"?e+"":e,t),t);import{B as w,y as d,d as B,o as v,a as y,e as a,A as _,t as p,C as D,n as N,p as F,i as L,_ as I,D as M,E as O,G as k,b as j,c as h,z as x,F as G,q as H,u as g,h as K,w as Q,m as U,v as f,k as J}from"./index-ab6ed2c3.js";import{a as R,s as X}from"./math-c3d3a642.js";import{B as Y}from"./BasicButton-d6adb06b.js";class Z{constructor(e){c(this,"addWeightInterval");c(this,"interval",200);c(this,"increment",.2);c(this,"weights");c(this,"sourceConfigs");c(this,"mergedConfig");c(this,"resultConfig",null);this.sourceConfigs=e,this.mergedConfig=w.cloneDeep(e[Number(Object.keys(e)[0])]),this.weights=d({});const t=1/Object.keys(e).length;for(const n in e){const o=n;this.weights.value[o]=t}}startAddWeight(e){const{interval:t}=this;this.addWeightInterval==null&&(this.addWeight(e),this.addWeightInterval=window.setInterval(()=>this.addWeight(e),t))}stopAddWeight(){this.addWeightInterval!=null&&(clearInterval(this.addWeightInterval),this.addWeightInterval=void 0)}addWeight(e){const{weights:t,increment:n}=this;t.value[e]+=n;for(const o in t.value)t.value[o]/=1+n;this.applyWeights()}applyWeights(){R(this.mergedConfig,this.sourceConfigs,this.weights.value),this.resultConfig&&w.merge(this.resultConfig,this.mergedConfig)}}const W=i=>(F("data-v-24864a90"),i=i(),L(),i),ee=W(()=>a("div",{class:"outer"},null,-1)),te=["onTouchstart"],se=W(()=>a("div",{class:"back"},null,-1)),ie={class:"center"},ne={class:"weight"},oe=B({__name:"BlendPipe",props:{color:{},width:{},weight:{},onTouchStart:{type:Function},onTouchEnd:{type:Function},isActive:{type:Boolean}},setup(i){const e=i;function t(){window.addEventListener("touchend",n),e.onTouchStart()}function n(){window.removeEventListener("touchend",n),e.onTouchEnd()}return(o,m)=>(v(),y("div",{class:N(["blend-pipe",{active:o.isActive}]),style:_({width:(.3+o.weight*.7)*o.width+"%"})},[ee,a("div",{class:"inner",style:_({backgroundColor:o.color})},null,4),a("div",{class:"button",onTouchstart:D(t,["prevent"])},[se,a("div",ie,[a("div",ne,p(Math.round(o.weight*10)),1)])],40,te)],6))}});const ae=I(oe,[["__scopeId","data-v-24864a90"]]),le={class:"blend-viz"},ce={class:"pipes"},re={class:"instructions"},de={class:"i1"},ue={class:"i2"},he=["src"],ge=["id"],ve={class:"button-container"},pe=B({__name:"BlendViz",props:{elId:{},fixedConfig:{},componentConfigs:{},questionSettings:{},pipeColors:{},maskSrc:{},particlesStyle:{}},setup(i){const e=i,t=d(null),n=new Z(e.componentConfigs);M(()=>{window.tsParticles.load(e.elId,e.fixedConfig).then(l=>{var r;t.value=l,n.resultConfig=(r=t.value)==null?void 0:r.actualOptions,n.applyWeights()})}),O(()=>{t.value&&t.value.destroy()});const o=d(null);k(o,s=>{s!=null?n.startAddWeight(s):n.stopAddWeight()});const m=j(),S=h(()=>n.weights.value),C=d(x[e.questionSettings.areaIdx][e.questionSettings.questionIdx]),b=h(()=>C.value.answers),z=h(()=>{const s={};for(let l=0;l<b.value.length;l++)s[l]=b.value[l].scores;return s}),T=m.progress.scores,V=h(()=>m.getQuestionHistory(e.questionSettings)),$=d(V.value.ss),q=w.debounce(A,1e3,{trailing:!0});k(S,()=>q(),{immediate:!0,deep:!0});function A(){const s=$.value;X(T,s,z.value,S.value);for(const l in s){const r=l;s[r]*=C.value.weight}}return(s,l)=>(v(),y("div",le,[a("div",ce,[(v(!0),y(G,null,H(g(n).weights.value,(r,u)=>(v(),U(ae,{key:u,"on-touch-start":()=>o.value=Number(u),"on-touch-end":()=>o.value=null,color:s.pipeColors[u],width:10,weight:r,"is-active":u==o.value},null,8,["on-touch-start","on-touch-end","color","weight","is-active"]))),128))]),a("div",re,[a("div",de,p(g(f)("see instructions","general")),1),a("div",ue,p(g(f)("1")),1)]),a("img",{class:"particles-mask-img",style:_(s.particlesStyle),src:`imgs/blend-viz/${s.maskSrc}`},null,12,he),a("div",{id:s.elId,class:"particles",style:_([{"mask-image":`url(imgs/blend-viz/${s.maskSrc})`,"-webkit-mask-image":`url(imgs/blend-viz/${s.maskSrc})`},s.particlesStyle])},null,12,ge),a("div",ve,[K(Y,{replace:""},{default:Q(()=>[J(p(g(f)("continue","general")),1)]),_:1})])]))}});const ye=I(pe,[["__scopeId","data-v-e59a64dc"]]);export{ye as B};
